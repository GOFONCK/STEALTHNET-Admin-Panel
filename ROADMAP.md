## Roadmap по устранению найденных уязвимостей

### 1. Безопасность платежных вебхуков
- **CrystalPay (`/api/webhook/crystalpay`, `app.py:1077`)**: внедрить проверку подписи/секретного ключа, отклонять запросы без валидного HMAC, логировать попытки обхода.
- **Heleket (`/api/webhook/heleket`, `app.py:1121`)**: аналогично, реализовать валидацию токена/подписи либо whitelisting IP-адресов провайдера.
- **Telegram Stars (`/api/webhook/telegram`, `app.py:1245`)**: использовать `secret_token` Telegram, проверять источник, обрабатывать только подписанные события.
- Протестировать все три потока (создание оплаты → получение вебхука → изменение подписки).

### 2. Исправление запросов фронтенда
- `admin-panel/src/components/ClientLayout.js:33` — убрать хардкод `http://127.0.0.1:5000`, заменить на относительный `/api/client/settings` или прокси через `REACT_APP_API_URL`.
- Проверить остальные запросы на наличие абсолютных ссылок, приводящих к утечке токена за границы домена.

### 3. Хранение и защита JWT
- Перевести токены из `localStorage` (`AuthContext.js`, `VerifyEmailPage.js`) в httpOnly Secure cookie либо Session Storage с дополнительной защитой.
- Настроить HTTP заголовки (CSP, SameSite) и внедрить Content Security Policy для снижения риска XSS.

### 4. Структура репозитория
- Удалить/игнорировать артефакты `backend.zip`, `build.zip` или настроить их автоматическую регенерацию; хранить только исходные файлы.
- Проверить, что CI/CD использует свежие исходники, а не упакованные архивы.

### 5. Дополнительные проверки
- Пройтись по `admin-panel/src` на предмет XSS, особенно там, где данные вставляются в DOM.
- Добавить автоматические тесты/healthchecks для webhook-эндпоинтов.
- Документировать процедуру генерации/ротации секретных ключей (ADMIN_TOKEN, FERNET_KEY и т.п.).
